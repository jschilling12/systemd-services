# systemd-services

https://roadmap.sh/projects/dummy-systemd-service

# Server

---

# **ROT13 Systemd Service – README**

This document explains how to run a PHP-based ROT13 UDP server (`server.php`) as a managed **systemd service** on Linux. It covers service file creation, correct paths, permissions, troubleshooting, and how to start/enable the service.

---

## **1. Prerequisites**

* A working PHP installation

  ```bash
  which php
  # usually /usr/bin/php
  ```
* Your PHP server script located somewhere in your home directory, e.g.:

  ```
  /home/<username>/server.php
  ```
* A valid Linux user that the service will run under (e.g., `jorda`)

---

## **2. Testing the Server Manually**

Before using systemd, verify you can start the server on your own:

### **Start the server**

```bash
$ php server.php
```

### **Test it from another terminal**

```bash
$ nc -u 127.0.0.1 10000
```

If this works, your script is ready to be managed by systemd.

---

## **3. Create the Systemd Service File**

Create:

```
/etc/systemd/system/rot13.service
```

Recommended full service configuration:

```ini
[Unit]
Description=ROT13 demo service
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/php /home/<username>/server.php
WorkingDirectory=/home/<username>
Restart=on-failure
User=<username>
Group=<username>

[Install]
WantedBy=multi-user.target
```

### **Important fields to update**

* `User=` → set your actual Linux username
* `ExecStart=` → must use **absolute paths**:

  * Absolute path to PHP binary (`/usr/bin/php`)
  * Absolute path to your `server.php` script

Systemd **cannot** use relative paths or quoted ExecStart commands.

---

## **4. Reload Systemd After Editing**

Every time you modify the unit file:

```bash
sudo systemctl daemon-reload
```

---

## **5. Start the Service**

```bash
sudo systemctl start rot13
```

Check status:

```bash
sudo systemctl status rot13
```

A successful output looks like:

```
Active: active (running)
└─ /usr/bin/php /home/<username>/server.php
```

---

## **6. Enable the Service at Boot**

```bash
sudo systemctl enable rot13
```

This creates the necessary symlink so the server automatically starts when the machine boots.

---

## **7. View Logs from the Service**

Follow the live logs:

```bash
sudo journalctl -u rot13.service -f
```

Show historical logs:

```bash
sudo journalctl -u rot13.service
```

---

## **8. Common Errors & Fixes**

### **❌ “203/EXEC”**

Means systemd could not execute the command.
Fix: ensure `ExecStart=` uses absolute paths:

```ini
ExecStart=/usr/bin/php /home/<username>/server.php
```

### **❌ “Interactive authentication required”**

You attempted to run a system-level unit without `sudo`.

Use:

```bash
sudo systemctl start rot13
```

### **❌ “bad unit file setting”**

A syntax error in the service file.
Fix: edit the service file and run:

```bash
sudo systemctl daemon-reload
```

---

## **9. Controlling the Service**

```bash
sudo systemctl start rot13
sudo systemctl stop rot13
sudo systemctl restart rot13
sudo systemctl status rot13
```

---

## **10. Summary**

1. Make sure `server.php` works via `php server.php`.
2. Test using `nc -u 127.0.0.1 10000`.
3. Create a proper systemd unit with **absolute paths** and correct user.
4. Run `systemctl daemon-reload` after edits.
5. Start the service with `systemctl start rot13`.
6. Enable at boot with `systemctl enable rot13`.

---

Dummy.sh
# Interacting with the service
sudo systemctl start dummy
sudo systemctl stop dummy
sudo systemctl enable dummy
sudo systemctl disable dummy
sudo systemctl status dummy

# Check the logs
sudo journalctl -u dummy -f
